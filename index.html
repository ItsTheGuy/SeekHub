<!--
  SeekHub
  Copyright (C) 2021 ItsTheGuy

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html lang="en" class="has-navbar-fixed-top" id="main">
  <head>
      <meta charset="utf-8">
        <link rel="icon" href="./assets/icon.webp">
        <link rel="shortcut icon" href="./assets/icon.png">
        <title>Place Name</title>
        <meta name="description" content="Description about the place">
        <meta property="og:title" content="Place Name"/>
        <meta property="og:description" content="Description about the place">
        <meta property="og:image" content="./assets/icon.png">
        <meta property="og:type" content="website"/>
        <meta property="og:url" content=""/>
        <meta property="og:locale" content="en_US"/>
        <link rel="canonical" href="">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css">
        <link rel="stylesheet" href="./core/styles/foundation.css">
        <link rel="preconnect" href="https://fonts.googleapis.com"> 
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Gemunu+Libre:wght@800&display=swap" rel="stylesheet"> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
  <body style="background-color: #ffffff; scroll-margin-top: 60px;" id="start">
  <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation" style="background-color: rgba(255, 255, 255, 0.80); backdrop-filter: blur(56px); -webkit-backdrop-filter: blur(56px); box-shadow: 0 2px 2px 0 rgba(50, 34, 56, 0.2);">
  <div class="navbar-brand">
    <div class="navbar-item" style="line-height: 15px;">
          <a style="font-weight: 900; color: black; text-shadow: -0.5px 0.5px grey;" href="#start"><span id="title1stLine">PLACE</span><br><span id="title2ndLine">NAME</span></a>
      </div>
  </div>
  <div id="navbarSection" style="align-items: stretch; display:flex;"></div>
  </div>
</nav>
  <section class="section" style="align-content: center;" id="mainSection"></section>
  </body>
  <footer class="footer" style="background-color: #f5f5f5;">
    <div class="content has-text-centered">
      <article id="footerNotices" class="message is-link" style="width: 75%; position: relative; left: 50%; transform: translate(-50%, 0%);" id="extraInfo">
        <div class="message-body" style="background-color: rgb(219, 219, 219); border-left-style: none; font-size: small; font-weight: 700; color: black;">
          <ol style="list-style-position: inside; margin-left: -2px; position: relative; bottom: 4px;">
            <li><span>Lorem ipsum dolor atmet.</span></li>
            <li><span>Lorem ipsum dolor atmet.</span></li>
            <li><span>Lorem ipsum dolor atmet.</span></li>
          </ol>
        </div>
      </article>
      <div class="has-text-white" style="font-display: swap; position: relative; line-height: 20px; top: 12px;">
        <span style="font-size: 36px; font-weight: 900; color: black;">PLACE NAME</span>
        <br>
        <span style="font-size: 12px; font-weight: 300; color: black;">Some legal notice if you want</span>
      </div>
  </footer>
  <script>
      function switchVisibility2Placeholder(id) {
        document.getElementById("imagePlaceholderProduct" + id).style.display = 'block';
        return;
      }
      function loadData() {
        try {
        fetch("./menu.json")
          .then(response => {
            return response.json();
          });
        }
        catch {
          console.log("Could not fetch data from server...")
        }
        finally {
          return {
            "categories": [
              {"tag": "drinks", "name": "Drinks"},
              {"tag": "dishes", "name": "Dishes"},
              {"tag": "liquors", "name": "Liquors"},
              {"tag": "sausages", "name": "Sausages"},
              {"tag": "meats", "name": "Meats"},
            ],
            "items": [
            {"id": 0, "type": "drinks", "image": "http://cdn.ecommercedns.uk/files/3/233233/8/9393648/f22a-00378949-cola-classic-1-5-litre.jpg", "name": "Example 1", "description": "Drink to drink", "price": "$1", "allergens": "IDK ðŸ˜…"},
            {"id": 1, "type": "drinks", "image": "http://www.dumpaday.com/wp-content/uploads/2019/12/pictures-10-2.jpg", "name": "Example 2", "description": "Drink to drink", "price": "$1", "allergens": "IDK ðŸ˜›"},
            {"id": 2, "type": "dishes", "image": "http://www.dumpaday.com/wp-content/uploads/2019/04/the-random-pics-495.jpg", "name": "Example 3", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ¥²"},
            {"id": 3, "type": "dishes", "image": "http://images4.fanpop.com/image/photos/23700000/Funny-random-23797915-1000-981.jpg", "name": "Example 4", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ¥²"},
            {"id": 4, "type": "liquors", "image": "https://yt3.ggpht.com/a/AATXAJzsHPys1EoSnxprcPapwsQsb1gr97KzKfnRBw=s900-c-k-c0xffffffff-no-rj-mo", "name": "Example 5", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "-"},
            {"id": 5, "type": "liquors", "image": "", "name": "Example 6", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "-"},
            {"id": 6, "type": "sausages", "image": "https://i.pinimg.com/736x/5f/d1/9a/5fd19a789854b87701b9200c45f210bf.jpg", "name": "Example 7", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ˜Ž"},
            {"id": 7, "type": "sausages", "image": "http://www.mandysam.com/img/random.jpg", "name": "Example 8", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ˜Ž"},
            {"id": 8, "type": "meats", "image": "http://bucket.trending.com/trending/imgur/2017-08-09/funny-random-meme-dump_FgQ1Arr.png", "name": "Example 9", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ˜œ"},
            {"id": 9, "type": "meats", "image": "https://sensilab.monash.edu/new-sensilab/wp-content/uploads/2017/08/4949794-random-image.jpg", "name": "Example 10", "description": "Lorem ipsum dolor...", "price": "$1", "allergens": "IDK ðŸ˜œ"}
          ]}
        }
      }

      const data = loadData(); // Load data from server

      // For each couple of categories add a section
      var numberOfSectionGroups = Math.round(data.categories.length/2);
      var numberOfGeneratedSectionGroups = 0;
      
      for (var i = 0; numberOfSectionGroups > i; i++) {
        var sectionGroupsElement = `
        <div class="columns" id="columnGroup${i}"></div>
        `;
        document.getElementById("mainSection").innerHTML += sectionGroupsElement;
      }
      
      // For each category add a new section to the page
      var actualGroup = 0
      var repetitionsOfGroup = 0

      for (var i in data.categories) {
        var elementData = data.categories[i];
        var navbarElement = `
        <a class="navbar-item hoverWithBlack resize" href="#${elementData.tag}">
          <span style="vertical-align: super;">${elementData.name}</span>
        </a>
        `;
        var sectionElement = `
        <div class="column">
        <section style="scroll-margin-top: 102px;" id="${elementData.tag}">
          <h2 class="subtitle" style="font-family: Arial, Helvetica, sans-serif; font-display: swap; font-size: 28px; font-weight: 900;">${elementData.name}<hr></h2>
          <div id="${elementData.tag}Container">
        </div>
        </section>
        </div>
        <br>
        </div>
        `;
        document.getElementById("navbarSection").innerHTML += navbarElement;
        document.getElementById("columnGroup" + actualGroup.toString()).innerHTML += sectionElement;
        if (repetitionsOfGroup == 1) {repetitionsOfGroup = 0; actualGroup += 1}
        else repetitionsOfGroup += 1
      }

      // For each element in menu add a new element to the page
      var lastType2Render = ""
      var numberLastTypeRendered = 0

      for (var i in data.items) {
        var elementData = data.items[i];
        if (elementData.type != lastType2Render) numberLastTypeRendered = 1;
        else numberLastTypeRendered += 1;
        lastType2Render = elementData.type;
        var element = `${((elementData.type == lastType2Render && numberLastTypeRendered != 1) ? "<hr style='position: relative; margin-top: -12px; bottom: 2px;'>":"")}
        <div class="productContainer">
          <div class="imageContainer">
            <span id="imagePlaceholderProduct${elementData.id}" class="material-icons placeholder" style="display: ${(elementData.image == "" ? "block":"none")};">
              photo_camera
            </span>
            <img class="productImage" src="${elementData.image}" style="display: ${(elementData.image == "" ? "none":"block")};" onerror="this.onerror=null; this.src=''; this.style.display='none'; switchVisibility2Placeholder(${elementData.id});">
          </div>
            <div class="infoContainer">
              <div style="display: block;">
                <span class="productName">${elementData.name}</span>
                <span class="productPrice">${elementData.price}</span>
              </div>
              <span class="productDescription">${elementData.description}</span>
              <br>
              <span class="productAllergens">${elementData.allergens}</span>
            </div>
        </div>`;
        document.getElementById(elementData.type + "Container").innerHTML += element;
      }
  </script>
</html>